\appendix
\scriptsize

\section{Installation} \label{app:installation}

These dependecies should be installed from the command line, having navigated to the project directory.

\begin{verbatim}
# We need pip to be installed to manage python packages
sudo apt-get install python-pip
pip install -U pip

# vitualenv enables us to install modules and packages local to our
# project, so we dont need to expose our system-level python
# installation to incompatible or otherwise obnoxious packages
# that might destabilize our other project, or OS in general
pip install virtualenv
virtualenv flask

# MySQL-python will enable us to query data (very useful!)
# Advice retrieved from http://codeinthehole.com/writing/how-to-set-up-mysql-for-python-on-ubuntu/
# there are some additional dependencies with MySQL-python that need
# to be installed at a system level
sudo apt-get install libmysqlclient-dev python-dev
# Documentation on working with MySQLdb is at: http://mysql-python.sourceforge.net/MySQLdb.html

# now we can install MySQL-python in our virtualenv using a local pip
./flask/bin/pip install MySQL-python

# flask itself is our web framework of choice
./flask/bin/pip install flask

# mock will be useful for unit testing
./flask/bin/pip install mock

# nose will serve as our test runner
# https://nose.readthedocs.org/en/latest/ Source: https://github.com/nose-devs/nose
./flask/bin/pip install nose

# gonna need numpy a lot probably!
# scipy is a pain. The following installation method is courtesy of:
# http://www.scipy.org/Installing_SciPy/Linux#head-d437bf93b9d428c6efeb08575f631ddf398374ea
# This installs rather a lot of stuff :-|
sudo apt-get build-dep python-numpy 
# the following command does a big build and throws all sorts of errors, which are apparently fine to ignore.
sudo apt-get -b source python-numpy 
./flask/bin/pip install scipy 

# install dependencies for python-recsys
flask/bin/pip install csc-pysparse networkx divisi2
# clone python-recsys from Git and set it up in virtualenv
git clone http://github.com/ocelma/python-recsys
cd python-recsys
../flask/bin/python setup.py install

# install matplotlib for graphing test results
# n.b. this is not subsequently installed in the virtualenv, but
# that isnt a problem as the graphing can be done without
# invoking any of our virtualenv
sudo apt-get install python-matplotlib
\end{verbatim}

\section{Source Data} \label{app:data}

\subsection{Migration} \label{app:datamigration}

These commands recreate the migration of data from the original Decanter.com wines database to the Sommelier database.

File./notes/queries.md. Modify the tasting notes database to remove nonsensical author names from the tasting table:

\begin{verbatim}
USE wines;
UPDATE tasting SET author = 'Christelle Guibert' where author = 'C hristelle Guibert';
UPDATE tasting SET author = '' WHERE author IN (
    'Rising stars',
    'New releases',
    'Great wine buys',
    'Panel Tasting',
    'Hot tip',
    'Wine of the month',
    'Wine of the week',
    'Connoisseur\'s choice',
    'Decanter choice',
    'Decanter Fine Wine Encounter 2002',
    'In the Decanter tasting room',
    'Christmas choice',
    ''
) OR author IS NULL;
\end{verbatim}



\begin{verbatim}
Select count of wines tasted by each taster in author column of \`tasting\`:

    select t.author, count(*) 
    from tasting as t 
    where author is not NULL 
      and author <> '' 
      and author not in (
        'Rising stars',
        'New releases',
        'Great wine buys',
        'Panel Tasting',
        'Hot tip',
        'Wine of the month',
        'Wine of the week',
        'Connoisseur\'s choice',
        'Decanter choice',
        'Decanter Fine Wine Encounter 2002',
        'In the Decanter tasting room',
        'Christmas choice'
      ) 
      group by t.author;

    +----------------------+----------+
    | author               | count(*) |
    +----------------------+----------+
    | Alan Spencer         |       19 |
    | Amy Wislocki         |       29 |
    | Andrew Jefford       |      105 |
    | Beverley Blanning MW |       13 |
    | Carolyn Holmes       |        1 |
    | Christelle Guibert   |      120 |
    | Clive Coates MW      |        6 |
    | David Peppercorn     |       45 |
    | Gerald D Boyd        |        7 |
    | Harriet Waugh        |      253 |
    | James Lawther MW     |      238 |
    | John Radford         |        2 |
    | Josephine Butchart   |       24 |
    | Norm Roby            |        4 |
    | Richard Mayson       |       14 |
    | Rosemary George MW   |        6 |
    | Serena Sutcliffe     |       31 |
    | Stephen Brook        |      491 |
    | Steven Spurrier      |      510 |
    +----------------------+----------+
    19 rows in set (0.03 sec)

Investigation of prices in tasting notes:

    select price from tasting 
    where price not like 'Â£%' 
      and price not like '$%' 
      and price != '' 
      and price is not null 
      and price not like 'n/a%' 
      and price not like 'POA' 
      and price not like '%TBC%' 
      and price not like 'na%' 
      and price not like '%Nicholas%' 
      and price not like '%old out%' 
      and price not like 'n./a%' 
      and price not like 'tcb%' 
      and price not like 'n/ a%' 
      and price not like '%request%' 
      and price not like '%poa%' 
      and price not like '%Howard Ripley%' 
      and price not like '%N\'/A%' 
      and price not like '%N/A%' 
      and price not like '%ut of%' 
      and price not like '%tba%' 
      and price not like '%trade%' 
      and price not like '%undefined%' 
      and price not like '%unreleased%'
      and price not like '%N/UK%'
      and price not like '%not released%'
      and price not like '%limited avail%'
      and price not like '%on reques%'
      and price not like '%not in st%'
      and price not like '%ice on ap%'
      and price not like '%JkN%'
      and price not like '%autumn%'
      and price not like '%#316'
      and price not like '%not ye%'
      and price not like '%Lib%';
      \end{verbatim}

How many wines are there which have been tasted by > 1 named author?

\begin{verbatim}
    mysql> select count(*) from wine w where 1 < ( select count(*) from tasting t2 where t2.author <> '' and t2.wine_id = w.id);
    +----------+
    | count(*) |
    +----------+
    |      104 |
    +----------+
    1 row in set (0.52 sec)

How many wines have been tasted by > 1 author, named or ''?

    mysql> select count(*) from wine w where 1 < ( select count(*) from tasting t2 where t2.wine_id = w.id);
    +----------+
    | count(*) |
    +----------+
    |     3225 |
    +----------+
    1 row in set (0.32 sec)


How many wines in total?

    mysql> select count(*) from wine;
    +----------+
    | count(*) |
    +----------+
    |    50539 |
    +----------+
    1 row in set (0.00 sec)

Generally speaking:

1918   Wines in denormalised_quick_search_data table associated with tastings with authors
1411   ... as above with rating > 0 (i.e. a valid rating)
31704  Wines in denormalised_quick_search_data with join to tasting
29185  ... as above with rating > 0
29732  ... as above with notes <> '' (i.e. written tasting note)
27232  ... as above with intersection of rating > 0 and notes <> ''`
Wine data completeness...

    SELECT COUNT(*) FROM sommelier WHERE (grape_variety IS NULL OR appellation IS NULL OR sub_region IS NULL OR region IS NULL OR country IS NULL OR producer IS NULL OR type IS NULL OR style IS NULL OR colour IS NULL);
    +----------+
    | COUNT(*) |
    +----------+
    |    21516 |
    +----------+
    1 row in set (0.04 sec)


    SELECT COUNT(*) FROM sommelier WHERE (grape_variety IS NULL OR appellation IS NULL OR sub_region IS NULL OR region IS NULL OR country IS NULL OR producer IS NULL);
    +----------+
    | COUNT(*) |
    +----------+
    |    14830 |
    +----------+
    1 row in set (0.00 sec)

    SELECT COUNT(*) FROM sommelier WHERE (grape_variety IS NULL OR appellation IS NULL);
    +----------+
    | COUNT(*) |
    +----------+
    |    14222 |
    +----------+
    1 row in set (0.00 sec)

    mysql> SELECT COUNT(*) FROM sommelier WHERE (grape_variety IS NULL);
    +----------+
    | COUNT(*) |
    +----------+
    |    13523 |
    +----------+
    1 row in set (0.00 sec)

    mysql> SELECT COUNT(*) FROM sommelier WHERE (grape_variety IS NOT NULL AND appellation IS NOT NULL AND sub_region IS NOT NULL AND region IS NOT NULL AND country IS NOT NULL AND producer IS NOT NULL AND type IS NOT NULL AND style IS NOT NULL AND colour IS NOT NULL );
    +----------+
    | COUNT(*) |
    +----------+
    |    10169 |
    +----------+
    1 row in set (0.05 sec)

## Conversion from latin1 to utf8:

Based on advice from: http://en.gentoo-wiki.com/wiki/Convert_latin1_to_UTF-8_in_MySQL

    From the Bash shell:
    $ mysqldump -uroot -p -hlocalhost --default-character-set=latin1 -c --insert-ignore --skip-set-charset -r wine_dump.sql wine
    $ file wine_dump.sql
    > wine_dump.sql: Non-ISO extended-ASCII English text, with very long lines
    $ iconv -f ISO8859-1 -t UTF-8 wine_dump.sql > wine_dump_utf8.sql
    $ sed -i 's/latin1/utf8/g' wine_dump_utf8.sql

    Now, from the MySQL command line:
    mysql> CREATE DATABASE sommelier CHARACTER SET utf8 COLLATE utf8_general_ci;

    And finally, back in the Bash shell:
    $ mysql -uroot --max_allowed_packet=16M -p --default-character-set=utf8 sommelier < wine_dump_utf8.sql

-----------------------------------------------------

mysql> select count(*) from tasting t join wine w on w.id = t.wine_id join wine_info wi on w.id = wi.id left join producers p on p.id = wi.producer_id left join wine_grape_variety gv on gv.id = wi.grape_variety where t.rating > 0 and t.notes <> '' and w.vintage > 1900 and w.vintage < 2013 and wi.appellation_id <> 0 order by rand() limit 2\G
*************************** 1. row ***************************
count(*): 14273
1 row in set (0.20 sec)

--------------------------------------------------------

Content for sommelier.wine:

CREATE TABLE `sommelier_wine` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(255) NOT NULL DEFAULT '',
  `vintage` int(4) NOT NULL DEFAULT '0',
  `grape_variety` varchar(255) NOT NULL DEFAULT '',
  `producer` varchar(255) NOT NULL DEFAULT '',
  `country` varchar(255) NOT NULL DEFAULT '',
  `region` varchar(255) NOT NULL DEFAULT '',
  `sub_region` varchar(255) NOT NULL DEFAULT '',
  `appellation` varchar(255) NOT NULL DEFAULT '',
  PRIMARY KEY (`id`)
) ENGINE=MyISAM AUTO_INCREMENT=1 DEFAULT CHARSET=utf8;

INSERT INTO sommelier_wine SELECT 
  w.id,
  w.name AS name, 
  w.vintage AS vintage, 
  p.producer_match AS producer, 
  gv.description AS description,
  c.country AS country,
  r.region AS region,
  sr.sub_region AS sub_region,
  a.appellation AS appellation
FROM
  wine w 
JOIN wine_info wi ON w.id = wi.id 
LEFT JOIN producers p ON p.id = wi.producer_id 
LEFT JOIN wine_grape_variety gv ON gv.id = wi.grape_variety 
LEFT JOIN appellation a ON a.id = wi.appellation_id
LEFT JOIN sub_region sr ON sr.id = a.sub_region_id
LEFT JOIN region r ON r.id = sr.region_id
LEFT JOIN country c ON c.id = r.country_id
ORDER BY w.id ASC;

Content for sommelier.author:

CREATE TABLE `sommelier_author` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(255) NOT NULL DEFAULT '',
  PRIMARY KEY (`id`)
) ENGINE=MyISAM AUTO_INCREMENT=1 DEFAULT CHARSET=utf8;

INSERT INTO sommelier_author SELECT DISTINCT
  NULL,
  t.author as name
FROM
  tasting t
WHERE t.author <> '';

Content for sommelier.tasting:

CREATE TABLE `sommelier_tasting` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `wine_id` int(11) NOT NULL,
  `author_id` int(11) NOT NULL,
  `rating` int(11) NOT NULL,
  `notes` TEXT NOT NULL,
  `tasting_date` datetime NOT NULL DEFAULT '0000-00-00 00:00:00',
  PRIMARY KEY (`id`),
  KEY `wine_idx` (`wine_id`),
  KEY `author_idx` (`author_id`)
) ENGINE=MyISAM AUTO_INCREMENT=1 DEFAULT CHARSET=utf8;

INSERT INTO sommelier_tasting SELECT
  NULL,
  t.wine_id AS wine_id,
  a.id AS author_id,
  t.rating AS rating,
  t.notes AS notes,
  t.tasting_date AS tasting_date
FROM
  tasting t 
JOIN wine w ON w.id = t.wine_id 
JOIN wine_info wi ON w.id = wi.id 
LEFT JOIN sommelier_author a ON t.author = a.name
WHERE t.rating > 0 
  AND t.notes <> '' 
ORDER BY w.id ASC;

Finally, delete all wines without tasting records:

DELETE FROM sommelier_wine WHERE id NOT IN ( SELECT wine_id FROM sommelier_tasting );

DROP TABLE wine;
DROP TABLE tasting;
DROP TABLE author;

RENAME TABLE sommelier_wine TO wine;

RENAME TABLE sommelier_tasting TO tasting;

RENAME TABLE sommelier_author TO author;

/*
mysql> show tables;
+---------------------+
| Tables_in_sommelier |
+---------------------+
| author              |
| tasting             |
| wine                |
+---------------------+
3 rows in set (0.00 sec)
*/


// Author ids...

+----+----------------------+
| id | name                 |
+----+----------------------+
|  1 | Steven Spurrier      |
|  2 | Beverley Blanning MW |
|  3 | James Lawther MW     |
|  4 | Josephine Butchart   |
|  5 | Rosemary George MW   |
|  6 | Norm Roby            |
|  7 | Clive Coates MW      |
|  8 | John Radford         |
|  9 | Gerald D Boyd        |
| 10 | Stephen Brook        |
| 11 | Christelle Guibert   |
| 12 | Alan Spencer         |
| 13 | Serena Sutcliffe     |
| 14 | Harriet Waugh        |
| 15 | Andrew Jefford       |
| 16 | David Peppercorn     |
| 17 | Richard Mayson       |
| 18 | Carolyn Holmes       |
| 19 | Amy Wislocki         |
+----+----------------------+

\end{verbatim}

\subsection{Sparsity} \label{app:datasparsity}

Sparsity of 94\% calculated by:

Distinct number of known authors in tasting table: 18

Total number of tastings by known authors: 1411

Distinct number of wine ids in tasting table with known author: 1307

Sparsity percentage = $100 - (( 1411 \div ( 1307 \times 18 )) \times 100) $

\subsection{Author Similarity} \label{app:authorsim}

Table data obtained in the Python interactive interpreter by the following commands (see also \ref{app:recommendations}):

\begin{verbatim}
import recommendations
recommendations.getAuthorSimilarities()
\end{verbatim}

\section{Experimental Code}

\subsection{Code derived from Segaran, 2007} \label{app:recommendations}

This code was copied largely from Segaran's exercises in Ch.2 of Collective Intelligence (2007). I have truncated part of the data fixture for brevity.

I have adapted Segaran's code, implementing new methods to query data from the Sommelier database and apply his methods to that data.

\begin{verbatim}
# a dictionary of critics and their ratings of a small
# set of movies
# copied from Segaran: Collective Intelligence (2006) Ch.2
critics={
    'Lisa Rose': {
        'Lady in the Water': 2.5,
        'Snakes on a Plane': 3.5,
        'Just My Luck': 3.0,
        'Superman Returns': 3.5,
        'You, Me and Dupree': 2.5,
        'The Night Listener': 3.0
    },
#### TRUNCATED ####
    'Toby': {
        'Snakes on a Plane': 4.5,
        'Superman Returns': 4.0,
        'You, Me and Dupree': 1.0
    }
}

# Method copied from Segaran: Collective Intelligence (2006) Ch.2
from math import sqrt
def sim_distance(prefs,person1,person2):
    si={}
    for item in prefs[person1]:
        if item in prefs[person2]:
            si[item]=1
    if len(si)==0: return 0
    sum_of_squares=sum([pow(prefs[person1][item]-prefs[person2][item],2)
    return 1/(1+sum_of_squares)

# This method is equivalent to sim_distance() above, uses scipy's sqeuclidean method
import scipy.spatial
def euclidean_distance(prefs,person1,person2):
    vector1=[]
    vector2=[]
    for item in prefs[person1]:
        if item in prefs[person2]:
            vector1.append(prefs[person1][item])
            vector2.append(prefs[person2][item])
    if len(vector1)==0: return 0
    euclidean_distance=scipy.spatial.distance.sqeuclidean(vector1,vector2)
    return 1 / (1 + euclidean_distance)

# Method copied from Segaran: Collective Intelligence (2006) Ch.2
def sim_pearson(prefs,p1,p2):
    si={}
    for item in prefs[p1]:
        if item in prefs[p2]: si[item]=1
    n=len(si)
    if n==0: return 0
    sum1=sum([prefs[p1][it] for it in si])
    sum2=sum([prefs[p2][it] for it in si])
    sum1Sq=sum([pow(prefs[p1][it],2) for it in si])
    sum2Sq=sum([pow(prefs[p2][it],2) for it in si])
    pSum=sum([prefs[p1][it]*prefs[p2][it] for it in si])
    # calculate Pearson score:
    num=pSum-(sum1*sum2/n)
    den=sqrt((sum1Sq-pow(sum1,2)/n)*(sum2Sq-pow(sum2,2)/n))
    if den==0: return 0
    r=num/den
    return r

# Method copied from Segaran: Collective Intelligence (2006) Ch.2
def topMatches(prefs,person,n=5,similarity=sim_pearson):
    scores=[(similarity(prefs,person,other), other)
            for other in prefs if other!=person]
    scores.sort()
    scores.reverse()
    return scores[0:n]

# Method copied from Segaran: Collective Intelligence (2006) Ch.2
# Gets recommendations for a person by using weighted average
# of every other user's rankings
def getRecommendations(prefs,person,similarity=sim_pearson):
    totals={}
    simSums={}
    for other in prefs:
        if other==person: continue
        sim=similarity(prefs,person,other)
        if sim<=0: continue
        for item in prefs[other]:
            # only score movies 'person' hasn't seen
            if item not in prefs[person] or prefs[person][item]==0:
                # similarity*score
                totals.setdefault(item,0)
                totals[item]+=prefs[other][item]*sim
                # sum of similarities
                simSums.setdefault(item,0)
                simSums[item]+=sim
    rankings=[(total/simSums[item],item) for item,total in totals.items()]
    rankings.sort()
    rankings.reverse()
    return rankings

# Method copied from Segaran: Collective Intelligence (2006) Ch.2
def transformPrefs(prefs):
    result={}
    for person in prefs:
        for item in prefs[person]:
            result.setdefault(item,{})
            result[item][person]=prefs[person][item]
    return result

# Method copied from Segaran: Collective Intelligence (2006) Ch.2
def calculateSimilarItems(prefs,n=10,similarity=sim_distance):
    result={}
    itemPrefs=transformPrefs(prefs)
    c=0
    for item in itemPrefs:
        c+=1
        if c%100==0: print "%d / %d" % (c,len(itemPrefs))
        scores=topMatches(itemPrefs,item,n=n,similarity=sim_distance)
        result[item]=scores
    return result

# Method copied from Segaran: Collective Intelligence (2006) Ch.2
def getRecommendedItems(prefs,itemMatch,user):
    userRatings=prefs[user]
    scores={}
    totalSim={}
    for (item,rating) in userRatings.items():
        for (similarity, item2) in itemMatch[item]:
            if item2 in userRatings: continue
            # Weighted sum of rating times similarity
            scores.setdefault(item2,0)
            scores[item2]+=similarity*rating
            # Sum of all the similarities
            totalSim.setdefault(item2,0)
            totalSim[item2]+=similarity
    # Divide each total score by total weighting to give an average
    rankings=[(score/totalSim[item],item) for item,score in scores.items()]
    rankings.sort()
    rankings.reverse()
    return rankings

# Method copied from Segaran: Collective Intelligence (2006) Ch.2
def loadMovieLens(path='../data/ml-100k'):
    movies={}
    for line in open(path+'/u.item'):
        (id,title)=line.split('|')[0:2]
        movies[id]=title
    prefs={}
    for line in open(path+'/u.data'):
        (user,movieid,rating,ts)=line.split('\t')
        prefs.setdefault(user,{})
        prefs[user][movies[movieid]]=float(rating)
    return prefs

def loadSommelierWines(comparator='rating'):
    import MySQLdb
    from MySQLdb.constants import FIELD_TYPE
    from MySQLdb.cursors import DictCursor
    converter = { FIELD_TYPE.LONG: int }
    connection = MySQLdb.connect(user="sommelier",db="sommelier",passwd="vinorosso",conv=converter)
    connection.set_character_set('utf8')
    cursor = connection.cursor(DictCursor)
    cursor.execute('SET NAMES utf8;')
    cursor.execute('SET CHARACTER SET utf8;')
    cursor.execute('SET character_set_connection=utf8;')
    cursor.execute("""
select w.name as wine, w.vintage, a.name as author, t.rating, t.notes 
from wine w join tasting t on t.wine_id = w.id join author a on a.id = t.author_id
    """)
    results = cursor.fetchall()
    prefs={}
    for row in results:
        user = row['author']
        wine = row['wine']
        vintage = row['vintage']
        rating = row['rating']
        notes = row['notes']
        prefs.setdefault(user,{})
        if comparator == 'notes':
            comp = row['notes']
        else:
            comp = row['rating'] + 0.0
        prefs[user][''.join([wine,str(vintage)])] = comp
    cursor.close()
    connection.close()
    return prefs

def loadSommelierAuthors():
    import MySQLdb
    from MySQLdb.constants import FIELD_TYPE
    from MySQLdb.cursors import DictCursor
    converter = { FIELD_TYPE.LONG: int }
    connection = MySQLdb.connect(user="sommelier",db="sommelier",passwd="vinorosso",conv=converter)
    connection.set_character_set('utf8')
    cursor = connection.cursor(DictCursor)
    cursor.execute('SET NAMES utf8;')
    cursor.execute('SET CHARACTER SET utf8;')
    cursor.execute('SET character_set_connection=utf8;')
    cursor.execute("""
select w.name as wine, w.vintage as vintage, a.name as author, t.rating as rating from wine w join tasting t on t.wine_id = w.id join author a on a.id = t.author_id
    """)
    results = cursor.fetchall()
    authors = {}
    for row in results:
        author = row['author']
        wine = ' '.join([row['wine'], str(row['vintage'])])
        rating = row['rating']
        authors.setdefault(author,{})
        authors[author][wine] = rating;
    cursor.close()
    connection.close()
    return authors

def getAuthorSimilarities(similarity=sim_pearson):
    authors = loadSommelierAuthors()
    sims = {}
    for author1 in authors.keys():
        sims.setdefault(author1, {})
        for author2 in authors.keys():
            if author1 == author2:
                continue
            sim = similarity(authors, author1, author2)
            if sim != 0:
                sims[author1][author2] = sim
    return sims
\end{verbatim}

\section{Data Access}

\subsection{Sommelier Database Connector}

A class managing database queries for the Sommelier application. This class implements only the minimum interface with the MySQLDB library, simply managing the lifecycle of a single cursor and exposing the cursor's execute(), fetchone() and fetchall() methods.

\begin{verbatim}
#!python

import math
import MySQLdb
from MySQLdb.constants import FIELD_TYPE
from MySQLdb.cursors import DictCursor

class SommelierDbConnector:
    
    cursor = None
    connection = None

    def __init__(self):
        converter = { FIELD_TYPE.LONG: int }
        self.connection = MySQLdb.connect(
                            user="sommelier",
                            db="sommelier",
                            passwd="vinorosso",
                            conv=converter)
        self.connection.set_character_set('utf8')
        self.cursor = self.connection.cursor(DictCursor)
        self.cursor.execute('SET NAMES utf8;')
        self.cursor.execute('SET CHARACTER SET utf8;')
        self.cursor.execute('SET character_set_connection=utf8;')

    def execute(self, query):
        return self.cursor.execute(query)

    def fetch_one(self):
        return self.cursor.fetchone()

    def fetch_all(self):
        return self.cursor.fetchall()

    def __del__(self):
        if self.cursor is not None:
            self.cursor.close()
        if self.connection is not None:
            self.connection.close()
\end{verbatim}

\section{API Design}

\subsection{API Routes}

\subsubsection{API Response: Index}\label{app:apiindex}
\begin{verbatim}
{
    ``type'': ``list'',
    ``self'': {
        ``title'': ``Sommelier API'',
        ``link'': ``/''
    },
    ``list'': [
        {
        ``title'': ``All Authors'',
        ``link'': ``/authors/1''
        },
        {
        ``title'': ``All Wines'',
        ``link'': ``/wines/1''
        }
    ]
}
\end{verbatim}

\subsubsection{API Response: Authors}\label{app:apiauthors}
\begin{verbatim}
{
    ``type'': ``list'',
    ``self'': {
        ``title'': ``Authors, Page 1''
        ``link'': ``/authors/1''
    },
    ``list'': [
        /* maximum 50 links per page */
        {
        ``title'': ``Mr. Author'',
        ``link'': ``/author/123''
        },
        {
        ``title'': ``A.N. Other'',
        ``link'': ``/author/234''
        }
    }
}
\end{verbatim}
    
\subsubsection{API Response: Author}\label{app:apiauthor}
\begin{verbatim}
{
    ``type'': ``author'',
    ``self'': {
        ``title'': ``Mr. Author'',
        ``name'': ``Mr. Author'',
        ``tastings'': [
            {
            ``rating'': 5,
            ``notes'': ``Tasting notes about the wine'',
            ``tasting_date'': ``2003-04-01 00:00:00'',
            ``wine'': {
                ``title'': ``Wine Name 1990'',
                ``link'': ``/wine/123''
            }
        ],
        ``link'': ``/author/123''
    },
    ``related_content'': {
        /* maximum of 5 wines */
        ``recommended_wines'': [
            {
            ``title'': ``Chateau du Vin 1996'',
            ``link'': ``/wine/234''
            }
        ],
        /* maximum of 5 other authors */
        ``similar_authors'': [
            {
            ``title'': ``A.N. Other'',
            ``link'': ``/author/234''
            }
        ]
    }
}
\end{verbatim}

\subsubsection{API Response: Wines}\label{app:apiwines}
\begin{verbatim}
{
    ``type'': ``list''
    ``self'': {
        ``title'': ``Wines, Page 1''
        ``link'': ``/wines/1''
    },
    ``list'': [
        /* maximum 50 links per page */
        {
        ``title'': ``Wine Name 1990'',
        ``link'': ``/wine/123''
        },
        {
        ``title'': ``Chateau du Vin 1996'',
        ``link'': ``/wine/234''
        }
    }
}
\end{verbatim}

\subsubsection{API Response: Wine}\label{app:apiwine}

\begin{verbatim}
{
    ``type'': ``wine'',
    ``self'': {
        ``title'': ``Wine Name 1990'',
        ``name'': ``Wine Name'',
        ``vintage'': 1990,
        ``producer'': ``Wine Producer Name'',
        ``grape_variety'': ``Cabernet Sauvignon'',
        ``appellation'': ``Pessac-Leognan'',
        ``country'': ``France'',
        ``region'': ``Bordeaux'',
        ``sub_region'': ``Graves''
        ``tastings'': [
            {
            ``rating'': 5,
            ``notes'': ``Tasting notes about the wine'',
            ``tasting_date'': ``2003-04-01 00:00:00'',
            ``author'': {
                ``title'': ``Mr. Author'',
                ``link'': ``/author/123''
            }
        ],
        ``link'': ``/wine/123''
    },
    ``related_content'': {
        /* maximum of 5 wines */
        ``similar_wines'': [
            {
            ``title'': ``Chateau du Vin 1996'',
            ``link'': ``/wine/2345''
            }
        ]
    }
}
\end{verbatim}

\normalsize
